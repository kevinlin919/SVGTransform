<html>
<head>
  <title>SVG Fixed Transformation</title>
<head>
<style type="text/css">
	body {
		padding:20px;
		padding-bottom:1000px;
	}
  .svg-block__wrapper {
        user-select: none;
        -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        -o-user-select: none;
  }
  .svg-block {
    border: solid 2px #cfcfcf;
    cursor:pointer;
    pointer-events: none;
  }
</style>

<body>
	<h1>Paint</h1>
  <div class="svg-block__wrapper">
    <object type="image/svg+xml" class="svg-block"
            data-url="https://4sdsn3rl5hpxbudsi4ggpbq4240tupgg.lambda-url.ap-northeast-1.on.aws/?name=paint5"
            data="https://4sdsn3rl5hpxbudsi4ggpbq4240tupgg.lambda-url.ap-northeast-1.on.aws/?name=paint5">
    </object>
  </div>
  <br>
  
	<h1>Hospital</h1>
  <div class="svg-block__wrapper">
    <object type="image/svg+xml" class="svg-block"
            data-url="https://4sdsn3rl5hpxbudsi4ggpbq4240tupgg.lambda-url.ap-northeast-1.on.aws/?name=hospital"
            data="https://4sdsn3rl5hpxbudsi4ggpbq4240tupgg.lambda-url.ap-northeast-1.on.aws/?name=hospital">
    </object>
  </div>
  <br>
  
  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script type="text/javascript">
    $(function() {
      var click_target = null;
      var click_target_x = 0;
      var click_target_y = 0;
	
      var click_x = 0;
      var click_y = 0;
	  
	    
	  function transform(e, is_click) {
        if (click_target) {
          click_x = e.pageX;
          click_y = e.pageY;
		  
          if (click_x < click_target_x) {
            click_x = click_target_x;
          }
          if (click_y < click_target_y) {
            click_y = click_target_y;
          }
		  
		  width = click_x - click_target_x;
		  height = click_y - click_target_y;
			console.log(click_x);
			console.log(click_y);
          click_target.css('width', width);
          click_target.css('height', height);
		  
			if (is_click) {
			  click_target.attr('data', click_target.data('url') + '&width=' + width + '&height=' + height);
			  click_target = null;
			}
        }
	  }
      
      $(".svg-block__wrapper").mousedown(function(e) {
		click_target = $(e.target).find('object');
		pos = click_target.position();
		click_target_x = pos.left;
		click_target_y = pos.top;
      });
      
      $(document).mousemove(function(e) {
		transform(e, false);
      });
      document.addEventListener('touchmove', function(e) {
		transform(e.targetTouches[0], false);
      });
      
      $(".svg-block__wrapper").mouseup(function(e) {
		transform(e, true);
      });
	    
      document.addEventListener('touchend', function(e) {
		transform({pageX: click_x, pageY: click_y}, true);
      });
      
    });
  </script>
</body>
</html>
